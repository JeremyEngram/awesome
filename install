#!/usr/bin/env bash

set -e
version="0.0.2"
awesome_dir="$HOME/awesome"
bin_dir="$HOME/bin"

# create $HOME/awesome dir
# create $HOME/bin dir
# git clone shinokada/awesome
# create a symlink in bin

# check if awesome dir exist. if not create it and add $HOME/awesome path to config file
fn_checkDir() {
    if [[ -z $1 ]]; then
        echo "Specify the directory."
        exit 1
    fi
    if [[ ! -d $1 ]]; then
        mkdir $1
        echo "$1 directory is created."
        exit
    fi

}

fn_check_cmd() {
    if [ ! "$(command -v $1)" ]; then
        echo "Please install $1"
        exit 1
    fi
}

# create a symlink in bin
fn_create_symlink() {
    # find the name of repo
    repo_name=$1
    # add a symlink
    ln -sf "${awesome_dir}/${repo_name}/${repo_name}" "${bin_dir}/${repo_name}"
}

# fn_install run git clone and create a symlink
install() {
    fn_checkDir $awesome_dir
    fn_checkDir $bin_dir
    fn_check_cmd git
    cd $awesome_dir
    url="https://github.com/shinokada/awesome.git"
    repo="awesome"
    git clone ${url} && fn_create_symlink ${repo} || eixt 1
    echo "${repo} installation completed."
    echo "Try ${repo} -h or which ${repo}."
}

# fn_uninstall removes a symlink and repo
uninstall() {
    cd $awesome_dir
    repo="awesome"
    rm -rf ${repo} && rm "${bin_dir}/${repo}" || exit 1
    echo "Unintalled ${repo}."
    echo "You can remove $HOME/awesome directory."
}

fn_say() {
    echo "Say hi"
}

fn_main() {
    if (($# > 0)); then
        case $1 in
        "install")
            fn_install $2
            ;;
        "uninstall") fn_uninstall $2 ;;
        "say") fn_say ;;
        esac
    fi
}

fn_main "$@"
# fn_say
